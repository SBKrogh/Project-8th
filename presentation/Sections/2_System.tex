
%%%%%%%%%%%% MID WAY AGENDA %%%%%%%%%%%%%%
% \begin{frame}<beamer>
% \frametitle{Ignacio Trojaola Bolinaga}
% \tableofcontents[currentsection]
% \end{frame}
%%%%%%%%%%%% MID WAY AGENDA %%%%%%%%%%%%%%

\subsection{Parameter estimation}

\begin{frame}{Modelling}{Parameter estimation}
\begin{itemize}
	\item<1-> Model accuracy
	\begin{itemize} 
		\item<1-> Estimate uncertain parameters 
	\end{itemize}	 
\end{itemize}

\begin{itemize}
	\item<2-> Known parameters:
	\begin{itemize}
		\item<2-> Valves
		\item<2-> Pumps 
		\item<2-> Water tower
		\item<2-> Pipe dimension
	\end{itemize}	
\end{itemize}

\begin{itemize}
\item<3-> Uncertain parameters:
	\begin{itemize}
		\item<3-> Pipe resistance
	\end{itemize}
\end{itemize}

\begin{itemize}
\item<4->[]	
\begin{figure}[H]
	\centering
	\input{Tikz/param_block.tex} 
\end{figure}\vspace{-0.5cm}		
\end{itemize}	
\end{frame}



\subsection{Nonlinear parameter estimation}

\begin{frame}{Modelling}{Nonlinear parameter estimation}
\begin{itemize}
	\item<1-> Estimation outcomes: 	
\end{itemize}

\begin{figure}[H]
  \centering
  \begin{minipage}[b]{0.4\textwidth}
    \input{Tikz/Node_10.tex}
%    \caption{Estimation comparison for node 10.}
  \end{minipage}
  \hfill
  \begin{minipage}[b]{0.4\textwidth}
   \input{Tikz/Node_15.tex}
%    \caption{Estimation comparison for node 15.}
  \end{minipage}
\end{figure}
\end{frame}

\subsection{Linear parameter estimation}

\begin{frame}{Modelling}{Linear parameter estimation}
\begin{itemize}
	\item<1-> Model linearization
	\begin{itemize}
		\item<1-> Taylor expansion
		\item<1-> Small signal model
	\end{itemize}	
\end{itemize}

\begin{itemize}
	\item<2-> Unknown parameters
	\begin{itemize}
		\item<2-> Pipe resistance
		\item<2-> Chord flow operating point
	\end{itemize}	
\end{itemize}

\begin{itemize}
	\item<3-> Linearized state-space model
	\begin{itemize}
		\item<3-> Estimate matrices
	\end{itemize}
\end{itemize}	

\begin{itemize}
	\item<3->[]
		\begin{equation}
		\pmb{B}\pmb{J {B}}^T \pmb{\dot{\hat{z}}} = -\pmb{M_p} \pmb{\hat{z}} + \pmb{N_p} \pmb{\hat{u}} - \pmb{B_o} \Delta \hat{p}_{wt} 
		\end{equation}
	\item<3->[]
		\begin{equation}
		\pmb{\hat{y}} = \pmb{C_{p,1}} \pmb{\hat{z}}  + \pmb{C_{p,2}}\pmb{\hat{u}}  
		\end{equation}	
\end{itemize}
\end{frame}


%\subsection{Linear parameter estimation}
\begin{frame}{Modelling}{Linear parameter estimation}
\begin{itemize}
	\item<1-> Differential pressure 
	\begin{itemize}
		\item<1->[] 
			\begin{figure}[H]
			\centering
			\input{Tikz/est_deltap_data_final.tex} 
			\end{figure}	
	\end{itemize}	
\end{itemize}

\begin{itemize}
	\item<2-> Valve opening degree
	\begin{itemize}
		\item<2->[] 
			\begin{figure}[H]
			\centering
			\input{Tikz/est_OD_data_final.tex} 
			\end{figure}	
	\end{itemize}	
\end{itemize}
\end{frame}

%\subsection{Linear parameter estimation}
\begin{frame}{Modelling}{Linear parameter estimation}
\begin{itemize}
	\item<1-> PMA 1 - Node 10
	\begin{itemize}
		\item<1->[] 
			\begin{figure}[H]
			\centering
			\input{Tikz/Node10_estimation_2.tex} 
			\end{figure}	
	\end{itemize}	
\end{itemize}

\begin{itemize}
	\item<2-> PMA 2 - Node 15
	\begin{itemize}
		\item<2->[] 
			\begin{figure}[H]
			\centering
			\input{Tikz/Node15_estimation_2.tex} 
			\end{figure}	
	\end{itemize}	
\end{itemize}
\end{frame}

%\subsection{Linear parameter estimation}
\begin{frame}{Modelling}{Linear parameter estimation}
\begin{itemize}
	\item<1-> Water tower
	\begin{itemize}
		\item<1->[] 
			\begin{figure}[H]
			\centering
			\input{Tikz/WT_estimation_2.tex} 
			\end{figure}	
	\end{itemize}	
\end{itemize}
\end{frame}


\subsection{State-space model for control}

\begin{frame}{Modelling}{State-space model for control}
\begin{itemize}
	\item<1-> Discretization 
	\begin{itemize}
		\item<1-> Forward euler
	\end{itemize}	
\end{itemize}

\begin{itemize}
	\item<2-> Discrete, linearized state-space model 
	\begin{itemize}
		\item<2->[]
		\begin{equation}
		\Delta p_{wt}[k+1] \approx A_d \Delta \hat{p}_{wt}[k]  + \pmb{B_d} \pmb{\hat{u}}[k] + \pmb{E_d} \pmb{\hat{d}}[k] 
		\end{equation}
		\item<2->[]
		\begin{equation}
 		\pmb{\hat{y}}[k] = \pmb{C_d} \Delta \hat{p}_{WT}[k] + \pmb{D_d} \pmb{\hat{u}}[k] + \pmb{K_d} \pmb{\hat{d}}[k]
		\end{equation}
	\end{itemize}	
\end{itemize}
\end{frame}

\subsection{Verification of model}

\begin{frame}{Modelling}{Verification of model}
\begin{itemize}
	\item<1-> Compare water tower dynamics
	\begin{itemize}
	\item<1-> Model
	\item<1-> Measurement
	\end{itemize}
\end{itemize}

\begin{figure}[H]
\centering
\input{Tikz/simulation_time_constant.tex}
\end{figure}


\end{frame}

%\subsection{Verification of model}

\begin{frame}{Modelling}{Verification of model}
\begin{itemize}
	\item<1-> Model behavior
	\begin{itemize}
		\item<1-> Differential pressure
		\item<1-> Valve opening degree
	\end{itemize}	
\end{itemize}

\begin{figure}[H]
   \centering
    \input{Tikz/input_simulation.tex}
\end{figure}

\end{frame}




